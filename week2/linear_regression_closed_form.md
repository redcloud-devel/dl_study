# 선형회귀 최소제곱 해 (Closed-form Solution)

## 1. 문제 설정

데이터 (x_i, y_i)가 주어졌을 때 다음과 같은 선형 모델을 가정한다.

y = w x + b

오차: ε_i = y_i - (w x_i + b)

목표는 오차 제곱합(SSE)을 최소화하는 것이다.

J(w, b) = Σ (y_i - (w x_i + b))²

------------------------------------------------------------------------

## 2. 행렬 표현

### 디자인 행렬

X = \[\[x_1, 1\], \[x_2, 1\], ... \[x_n, 1\]\]

### 파라미터 벡터

θ = \[w, b\]\^T

### 예측값

ŷ = Xθ

------------------------------------------------------------------------

## 3. 목적 함수 (행렬형)

J(θ) = \|\| y - Xθ \|\|² = (y - Xθ)\^T (y - Xθ)

------------------------------------------------------------------------

## 4. 최소 조건 (미분)

∂J/∂θ = -2 X\^T (y - Xθ)

최소값에서 gradient = 0:

X\^T (y - Xθ) = 0

------------------------------------------------------------------------

## 5. 정규방정식

X\^T X θ = X\^T y

------------------------------------------------------------------------

## 6. 닫힌해

X\^T X 가 가역이면,

θ = (X\^T X)\^(-1) X\^T y

Python 구현:

``` python
theta = np.linalg.inv(X.T @ X) @ X.T @ y
```

------------------------------------------------------------------------

## 7. 기하학적 해석

-   Xθ는 X의 열공간에 존재
-   y를 해당 공간에 직교 투영한 결과가 Xθ
-   잔차 y - Xθ 는 열공간에 직교
-   그 조건이 X\^T (y - Xθ) = 0

------------------------------------------------------------------------

## 8. 실무 주의사항

X\^T X 가 역행렬이 안 되는 경우: - 데이터 부족 - 다중공선성

대안:

``` python
theta = np.linalg.lstsq(X, y, rcond=None)[0]
theta = np.linalg.pinv(X) @ y
```

------------------------------------------------------------------------

## 9. 요약

선형회귀는 오차 제곱합 최소화 문제이며, 미분 → 정규방정식 → 닫힌해
형태로 해결된다.
